import { CodeAnn } from '@components/code-ann'
import { Box, Boxes } from '@components/box'
import { InlineMath } from 'react-katex'
import { Figure } from '@components/figure'

<style jsx>{`
  h2 {
    padding-bottom: 0.5rem;
    border-bottom: 2px solid #bbb;
  }
`}</style>`

# Справка по JavaScript

<div id="assign">
## Оператор `=`
</div>

<Boxes>
  <Box>
    Оператор `=` ("присваивание") меняет значение переменной:
  </Box>
  <Box>
    <CodeAnn ok="Теперь в message будет 'Bye'">
      ```js
      let message = 'Hello';
      // mark
      message = 'Bye';
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Еще `=` может менять элементы массива:
  </Box>
  <Box>
    <CodeAnn ok="arr = ['X', 'b', 'c']">
      ```js
      let arr = ['a', 'b', 'c'];
      // mark
      arr[0] = 'X';
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    А также менять свойства объекта и добавлять новые:
  </Box>
  <Box>
    <CodeAnn ok="character = { name: 'Noelle', species: 'reindeer' }">
      ```js
      let character = { name: 'Kris' };
      // mark
      character.name = 'Noelle';
      // mark
      character.species = 'reindeer';
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    **Справа от `=` может быть любое выражение.** Например, можно сослаться на ту же саму переменную:
  </Box>
  <Box>
    <CodeAnn ok="x = 36">
      ```js
      let x = 6;
      // mark
      x = x * x;
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="invalid-left-hand-side-in-assignment">
  <Box>
    **А вот слева от `=` может быть только что-то, что можно менять.** Иначе будет ошибка:
  </Box>
  <Box>
    <CodeAnn error="SyntaxError: Invalid left-hand side in assignment">
      ```js
      let message = 'Hello';
      // mark
      'Bye' = message;
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="inc-dec">
## Операторы `++` и `--`
</div>

<Boxes>
  <Box>
    Операторы `++` и `--` увеличивают и уменьшают переменную на 1 соответственно.
  </Box>
  <Box>
    <CodeAnn ok="Теперь a = 2, b = 9">
      ```js
      let a = 1, b = 10;
      a++;
      b--;
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    С помощью `++` и `--` можно увеличивать или уменьшать **только на 1.** Например, `a++2` не сработает.
  </Box>
  <Box>
    <CodeAnn error="SyntaxError: Unexpected number">
      ```js
      // mark
      a++2;
      
      // Правильно было бы либо a += 2, либо a = a + 2
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="autoassign">
## Операторы `+=`, `-=`, `*=`, `/=`
</div>

<Boxes>
  <Box>
    Операторы `+=` и `-=` — это сокращенные операции присваивания.
    
    Например, `a += 2` — это то же самое, что и `a = a + 2`. То есть, `a` увеличится на 2.
  </Box>
  <Box>
    <CodeAnn ok="Теперь a = 102, b = 98">
      ```js
      let a = 100, b = 100;
      a += 2;
      b -= 2;
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    `*=` и `/=` тоже существуют, но используются реже.

    <small>А `%=` и `**=` — еще реже.</small>
  </Box>
  <Box>
    <CodeAnn ok="Теперь c = 200, d = 50">
      ```js
      let c = 100, d = 100;
      c *= 2;
      d /= 2;
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="modulo">
## Оператор `%`
</div>

<Boxes>
  <Box>
    Оператор `%` возвращает остаток от деления одного числа на другое.

    Например:
    
    * `100 % 3` будет равно `1`, потому что <InlineMath math="100 = 33 \times 3 + 1" />.
    * `100 % 4` будет равно `0`, потому что <InlineMath math="100" /> делится на <InlineMath math="4" /> нацело.
  </Box>
  <Box>
    <CodeAnn ok="Напечатает 0, 0, 1, 0">
      ```js
      let a = 100;
      console.log(a % 1, a % 2, a % 3, a % 4);
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Еще `%` часто используют, чтобы сбрасывать чиcло до нуля, когда оно дошло до какого-то предела:
  </Box>
  <Box>
    <CodeAnn ok="Напечатает 0, 1 .. 99 и так десять раз">
      ```js
      let n = 0;
      for (let i = 0; i < 1000; i++) {
        // mark
        n = (n+1) % 100;  // n ограничено между 0 и 99
        console.log(n);
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="eq-neq">
## Операторы `===` и `!==`
</div>

<Boxes>
  <Box>
    Операторы `===` и `!==` значат "равно" и "не равно":
  </Box>
  <Box>
    <CodeAnn ok="Выводит false и true">
      ```js
      console.log(100 === 3);
      console.log(100 !== 3);
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="eqeqeq">
  <Box>
    **В отличие от `==` и `!=`, операторы `===` и `!==` не приводят разные типы друг к другу.**

    Лучше всегда использовать `===` и `!==`, чтобы избежать ошибок. Стайлгайды многих компаний запрещают использовать `==` и `!=`.

    <p className="small">Подробные правила сравнения, которыми пользуется JavaScript, описаны в [The Abstract Equality Comparison Algorithm](https://262.ecma-international.org/5.1/#sec-11.9.3).</p>
  </Box>
  <Box>
    <CodeAnn warn="Во всех этих случаях == дает true, а === дает false">
      ```js
      console.log( 100 == ' 100',     100 === ' 100'   );
      console.log(   1 == true,         1 === true     );
      console.log(null == undefined, null === undefined);
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="less-more">
## Операторы `>`, `<`, `>=`, `<=`
</div>

<Boxes>
  <Box>
    Операторы `>` и `<` значат "больше" и "меньше":
  </Box>
  <Box>
    <CodeAnn ok="Выводит true и false">
      ```js
      console.log(100 > 3);
      console.log(100 < 3);
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Операторы `>=` и `<=` значат "больше или равно" и "меньше или равно", как знаки <InlineMath math="\geq"/> и <InlineMath math="\leq"/> в математике:
  </Box>
  <Box>
    <CodeAnn ok="Оба выводят true">
      ```js
      console.log(100 >= 3);
      console.log(100 >= 100);
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Эти операторы работают не только для чисел, но и для строк.

    Они сравнивают строки так, как они располагались бы в словаре. Например, `"a"` меньше `"b"`, потому что "a" идёт раньше "b" в алфавите. Большие буквы идут перед маленькими.
  </Box>
  <Box>
    <CodeAnn ok="Оба выводят true">
      ```js
      console.log("a" < "b");
      console.log("A" < "a");
      ```
    </CodeAnn>
  </Box>
</Boxes>

Ниже приведен порядок, в котором цифры, символы и латинские буквы упорядочены в JavaScript:

<Figure image="/ascii.png" />

<div id="rounding">
## Округление: `Math.floor`, `Math.ceil`, `Math.round`, `Math.trunc`
</div>

<Boxes id="floor">
  <Box>
    <InlineMath math="\lfloor x \rfloor"/> — `Math.floor` — округляет число **вниз до целого:**
  </Box>
  <Box>
    <CodeAnn ok="Выводит 3 и -4">
      ```js
      console.log(Math.floor(3.9));
      console.log(Math.floor(-3.9));
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="ceil">
  <Box>
    <InlineMath math="\lceil x \rceil"/> — `Math.ceil` — округляет число **вверх до целого:**
  </Box>
  <Box>
    <CodeAnn ok="Выводит 4 и -3">
      ```js
      console.log(Math.floor(3.1));
      console.log(Math.floor(-3.1));
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="round">
  <Box>
    `Math.round` округляет число **до ближайшего целого.** 0.5 округляется вверх.
  </Box>
  <Box>
    <CodeAnn ok="Все строчки выводят 4">
      ```js
      console.log(Math.round(3.5));
      console.log(Math.round(3.9));
      console.log(Math.round(4.2));
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="trunc">
  <Box>
    `Math.trunc` **отрезает от числа дробную часть.**
  </Box>
  <Box>
    <CodeAnn ok="Все строчки выводят 4">
      ```js
      console.log(Math.trunc(4.1));
      console.log(Math.trunc(4.9));
      console.log(Math.trunc(-4.1));
      console.log(Math.trunc(-4.9));
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="math-is-not-defined">
  <Box>
    В JavaScript есть разница между большими и маленькими буквами. Если написать `math.floor` вместо `Math.floor`, то будет ошибка:
  </Box>
  <Box>
    <CodeAnn error="ReferenceError: math is not defined">
      ```js
      console.log(math.trunc(4.1));
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="let">
## `let` 
</div>

<Boxes>
  <Box>
    `let` создает новую переменную. Если не указано значение, то переменная будет равна `undefined`.
  </Box>
  <Box>
    <CodeAnn ok="a = 5, b = undefined">
      ```js
      let a = 5;   // Создает новую переменную со значением 5
      let b;       // Создает пустую переменную
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Можно создавать несколько переменных сразу:
  </Box>
  <Box>
    <CodeAnn ok="a = 5, b = 6, c = undefined">
      ```js
      let a = 5, b = 6, c;
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="identifier-has-already-been-declared">
  <Box>
    Если переменная с таким именем уже есть, будет ошибка:
  </Box>
  <Box>
    <CodeAnn error="SyntaxError: Identifier 'a' has already been declared">
      ```js
      let a = 5;
      // mark
      let a = 6;
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="if">
## `if`
</div>

<Boxes>
  <Box>
    `if` проверяет условие и выполняет код внутри фигурных скобок, если условие верно.
  </Box>
  <Box>
    <CodeAnn ok="Выводит 'Верно'">
      ```js
      if (2 * 2 === 4) {
        console.log('Верно')
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="if-else">
  <Box>
    Можно добавить `else`, который выполнится, если условие не верно:
  </Box>
  <Box>
    <CodeAnn ok="Выводит 'Неверно'">
      ```js
      if (2 * 2 === 5) {
        console.log('Верно')
      } else {
        console.log('Неверно')
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Если забыть скобки вокруг условия, то будет ошибка:
  </Box>
  <Box>
    <CodeAnn error="SyntaxError: Unexpected number">
      ```js
      // mark
      if 2 * 2 === 4 {
        console.log('Верно')
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Если надо выполнить только одну команду, можно не использовать фигурные скобки.
  </Box>
  <Box>
    <CodeAnn ok="Выводит 'Верно'">
      ```js
      if (2 * 2 === 4) console.log('Верно');
      ```
    </CodeAnn>
  </Box>
</Boxes>
    
<Boxes>
  <Box>
    Но если забыть про фигурные скобки, когда команд больше одной, **то все команды, кроме первой, просто не попадут в `if`:**
  </Box>
  <Box>
    <CodeAnn warn="Выделенная строчка выполнится, хотя не должна">
      ```js
      // mark[42:53]
      if (2 * 2 === 5) console.log('Неверно'); failCount++;
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="for">
## `for`
</div>

<Boxes>
  <Box>
    `for` создает цикл. Он будет выполняться, **пока условие верно.** Например:
  </Box>
  <Box>
    <CodeAnn ok="Выводит 1, 2, 3, 4, 5, 6, 7, 8, 9, 10">
      ```js
      for (let i = 1; i <= 10; i++) {
        console.log(i);
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Вместо `i++` можно использовать любую другую команду. Например, умножаем `i` на 2:
  </Box>
  <Box>
    <CodeAnn ok="Выводит 1, 2, 4, 8, 16, 32">
      ```js
      for (let i = 1; i <= 50; i *= 2) {
        console.log(i);
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Если забыть изменять счетчик, то цикл будет бесконечным:
  </Box>
  <Box>
    <CodeAnn warn="i + 1 не изменяет переменную, поэтому цикл зависнет">
      ```js
      // mark[24:28]
      for (let i = 0; i < 3; i + 1) {
        console.log('Hello');
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes>
  <Box>
    Если неправильно написать условие, цикл тоже может стать бесконечным или, наоборот, не выполнится ни разу:
  </Box>
  <Box>
    <CodeAnn warn="i > 3 уже сразу не выполняется, поэтому цикл ничего не сделает">
      ```js
      // mark[17:21]
      for (let i = 0; i > 3; i++) {
        console.log('Hello');
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<div id="function">
## `function`
</div>

<Boxes>
  <Box>
    `function` создает функцию.
    
    У функции есть имя, параметры и тело — то, что функция будет делать.
  </Box>
  <Box>
    <CodeAnn ok="Функция объявлена и ее можно использовать: hello()">
      ```js
      function hello() {
        console.log('Hello');
      }
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="return">
  <Box>
    Еще функция может **возвращать результат** с помощью слова `return`.
    
    Например, функция `max` возвращает большее из двух чисел:
  </Box>
  <Box>
    <CodeAnn ok="Выводит 10">
      ```js
      function max(a, b) {
        if (a > b) return a; else return b;
      }

      // mark
      console.log(max(5, 10));
      ```
    </CodeAnn>
  </Box>
</Boxes>

<Boxes id="return">
  <Box>
    **Как только `return` выполняется, функция заканчивается.**

    (Если хочется сделать несколько проверок, то можно использовать `else if` или создать отдельную переменную `result` и возвращать ее в самом конце функции.)
  </Box>
  <Box>
    <CodeAnn warn="Вернет 10, потому что 'return' закончил функцию">
      ```js
      function max3(a, b, c) {
        // mark
        if (a > b) return a;
        if (b > c) return b;
        if (c > a) return c;
      }

      console.log(max3(10, 5, 9999));
      ```
    </CodeAnn>
  </Box>
</Boxes>

